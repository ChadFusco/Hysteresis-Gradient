'Note: This script reads all .xls, .xlsx, and .csv files in the same directory as the script. All spreadsheet files must have x-axis data in the first column and y-axis data in the second column'
timeinterval = input('Please enter the time interval of the data in seconds');
XAxisLabel = input('Enter x-axis label','s');
YAxisLabel = input('Enter y-axis label','s');
defaultcmap = [0,0,0.5625;
0,0,0.625;
0,0,0.6875;
0,0,0.75;
0,0,0.8125;
0,0,0.875;
0,0,0.9375;
0,0,1;
0,0.0625,1;
0,0.125,1;
0,0.1875,1;
0,0.25,1;
0,0.3125,1;
0,0.375,1;
0,0.4375,1;
0,0.5,1;
0,0.5625,1;
0,0.625,1;
0,0.6875,1;
0,0.75,1;
0,0.8125,1;
0,0.875,1;
0,0.9375,1;
0,1,1;
0.053431373,0.990931392,0.9375;
0.106862746,0.981862724,0.875;
0.160294116,0.972794116,0.8125;
0.213725492,0.963725507,0.75;
0.267156869,0.954656839,0.6875;
0.320588231,0.945588231,0.625;
0.374019623,0.936519623,0.5625;
0.427450985,0.927451015,0.5;
0.480882347,0.918382347,0.4375;
0.534313738,0.909313738,0.375;
0.58774513,0.90024513,0.3125;
0.641176462,0.891176462,0.25;
0.694607854,0.882107854,0.1875;
0.748039246,0.873039246,0.125;
0.801470578,0.863970578,0.0625;
0.854901969,0.854901969,0;
0.863970578,0.801470578,0;
0.873039246,0.748039246,0;
0.882107854,0.694607854,0;
0.891176462,0.641176462,0;
0.90024513,0.58774513,0;
0.909313738,0.534313738,0;
0.918382347,0.480882347,0;
0.927451015,0.427450985,0;
0.936519623,0.374019623,0;
0.945588231,0.320588231,0;
0.954656839,0.267156869,0;
0.963725507,0.213725492,0;
0.972794116,0.160294116,0;
0.981862724,0.106862746,0;
0.990931392,0.053431373,0;
1,0,0;
0.9375,0,0;
0.875,0,0;
0.8125,0,0;
0.75,0,0;
0.6875,0,0;
0.625,0,0;
0.5625,0,0;
0.5,0,0];
redcmap = [1,0,0;
0.9841,0,0;
0.9682,0,0;
0.9523,0,0;
0.9364,0,0;
0.9205,0,0;
0.9046,0,0;
0.8887,0,0;
0.8728,0,0;
0.8569,0,0;
0.841,0,0;
0.8251,0,0;
0.8092,0,0;
0.7933,0,0;
0.7774,0,0;
0.7615,0,0;
0.7456,0,0;
0.7297,0,0;
0.7138,0,0;
0.6979,0,0;
0.682,0,0;
0.6661,0,0;
0.6502,0,0;
0.6343,0,0;
0.6184,0,0;
0.6025,0,0;
0.5866,0,0;
0.5707,0,0;
0.5548,0,0;
0.5389,0,0;
0.523,0,0;
0.5071,0,0;
0.4912,0,0;
0.4753,0,0;
0.4594,0,0;
0.4435,0,0;
0.4276,0,0;
0.4117,0,0;
0.3958,0,0;
0.3799,0,0;
0.364,0,0;
0.3481,0,0;
0.3322,0,0;
0.3163,0,0;
0.3004,0,0;
0.2845,0,0;
0.2686,0,0;
0.2527,0,0;
0.2368,0,0;
0.2209,0,0;
0.205,0,0;
0.1891,0,0;
0.1732,0,0;
0.1573,0,0;
0.1414,0,0;
0.1255,0,0;
0.1096,0,0;
0.0937,0,0;
0.0778,0,0;
0.0619,0,0;
0.046,0,0;
0.0301,0,0;
0.0142,0,0;
0,0,0];
bluecmap = [0,0,1;
0,0,0.9841;
0,0,0.9682;
0,0,0.9523;
0,0,0.9364;
0,0,0.9205;
0,0,0.9046;
0,0,0.8887;
0,0,0.8728;
0,0,0.8569;
0,0,0.841;
0,0,0.8251;
0,0,0.8092;
0,0,0.7933;
0,0,0.7774;
0,0,0.7615;
0,0,0.7456;
0,0,0.7297;
0,0,0.7138;
0,0,0.6979;
0,0,0.682;
0,0,0.6661;
0,0,0.6502;
0,0,0.6343;
0,0,0.6184;
0,0,0.6025;
0,0,0.5866;
0,0,0.5707;
0,0,0.5548;
0,0,0.5389;
0,0,0.523;
0,0,0.5071;
0,0,0.4912;
0,0,0.4753;
0,0,0.4594;
0,0,0.4435;
0,0,0.4276;
0,0,0.4117;
0,0,0.3958;
0,0,0.3799;
0,0,0.364;
0,0,0.3481;
0,0,0.3322;
0,0,0.3163;
0,0,0.3004;
0,0,0.2845;
0,0,0.2686;
0,0,0.2527;
0,0,0.2368;
0,0,0.2209;
0,0,0.205;
0,0,0.1891;
0,0,0.1732;
0,0,0.1573;
0,0,0.1414;
0,0,0.1255;
0,0,0.1096;
0,0,0.0937;
0,0,0.0778;
0,0,0.0619;
0,0,0.046;
0,0,0.0301;
0,0,0.0142;
0,0,0];
hdr = input('Enter number of header lines');
usercmap = input('Default time color scale is Rainbow (blue to red). Hit Return for default, or enter alternative colormap. Options include red, blue, winter, copper, and cool','s');
if strcmp(usercmap,'')
    colormap(defaultcmap);
elseif strcmp(usercmap,'blue')
    colormap(bluecmap);
elseif strcmp(usercmap,'red')
    colormap(redcmap);
else
    colormap(usercmap);
end
excelfiles = dir('*.xls*');
excelnames = {excelfiles(:).name};
csvfiles = dir('*.csv');
csvnames = {csvfiles(:).name};
csvexcelfiles = [csvnames,excelnames];
FileNumber = max(size(csvexcelfiles));
counter = 1;
while counter < FileNumber + 1
    filenameraw = csvexcelfiles(counter);
    filename = cell2mat(filenameraw);
    if strcmp(filename(end-2:end),'csv')
        rawdata = csvread(filename);
    else
        rawdata = xlsread(filename);
    end
    x = transpose(rawdata(hdr+1:end,1));
    y = transpose(rawdata(hdr+1:end,2));
    endtime = (max(size(x))-1)*timeinterval;
    col = 0:timeinterval:endtime;
    z = zeros(size(col));
    Graph1 = surface([x;x],[y;y],[z;z],[col;col],'facecol','no','edgecol','interp','linew',2);
    colorbar('FontSize',12,'FontWeight','bold');
    xlabel(XAxisLabel,'FontSize',12,'FontWeight','bold');
    ylabel(YAxisLabel,'FontSize',12,'FontWeight','bold');
    set(gca,'FontSize',12,'FontWeight','bold','XGrid','on','YGrid','on','Box','on');
    imgname = strtok(filename,'.');
    title(imgname,'Interpreter','none','FontSize',13,'FontWeight','bold');
    print('-dpng',imgname)
    counter = counter + 1;
    delete(Graph1);
end